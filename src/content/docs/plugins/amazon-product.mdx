---
title: Amazon Product Plugin
description: Plugin integrado para importar, gestionar y mostrar productos de Amazon con afiliaci√≥n.
sidebar:
  label: Amazon Product
  order: 10
---

El **Amazon Product Plugin** permite buscar, importar y mostrar productos de Amazon en tu sitio Glory. Incluye integraci√≥n con la API de Amazon Data, soporte para afiliados, personalizaci√≥n de dise√±o y actualizaciones autom√°ticas.

## üöÄ Cu√°ndo usarlo

√ösalo cuando necesites:
- **Monetizar** tu contenido con enlaces de afiliados de Amazon.
- **Mostrar grids de productos** con precios, valoraciones y estado Prime actualizados.
- **Importar datos** de productos (t√≠tulo, imagen, ASIN) r√°pidamente desde el admin.
- **Filtrar y ordenar** productos en el frontend sin recargar la p√°gina (AJAX).

No lo uses si:
- Necesitas un sistema de e-commerce completo con carrito de compras (usa WooCommerce).
- Vendes productos propios y no de Amazon.

## üõ†Ô∏è Configuraci√≥n

Antes de usar el plugin, debes configurarlo en **Productos Amazon > Settings > API Settings**.

### Par√°metros de Configuraci√≥n

| Opci√≥n | Descripci√≥n | Ejemplo |
| :--- | :--- | :--- |
| **RapidAPI Key** | Tu clave de API para Amazon Data. | `a1b2c3d4...` |
| **RapidAPI Host** | El host de la API (generalmente fijo). | `amazon-data.p.rapidapi.com` |
| **Region** | La regi√≥n de Amazon para los datos y enlaces. | `Spain (ES)`, `United States (US)` |
| **Affiliate Tag** | Tu ID de afiliado de Amazon. Se a√±ade a todos los enlaces. | `myaffiliate-21` |
| **Sync Frequency** | Frecuencia de actualizaci√≥n autom√°tica de precios. | `Daily`, `Weekly`, `Off` |
| **Plugin Language** | Idioma de la interfaz del frontend. | `Espa√±ol`, `English` |

## üíª Uso B√°sico (Shortcode)

La forma principal de mostrar productos es mediante el shortcode `[amazon_products]`.

```php
// Ejemplo b√°sico en editor o PHP
echo do_shortcode('[amazon_products limit="12" orderby="date"]');
```

### Atributos del Shortcode

| Atributo | Tipo | Default | Descripci√≥n |
| :--- | :--- | :--- | :--- |
| `limit` | `int` | `12` | N√∫mero de productos por p√°gina. |
| `min_price` | `float` | `''` | Filtro inicial de precio m√≠nimo. |
| `max_price` | `float` | `''` | Filtro inicial de precio m√°ximo. |
| `only_prime` | `bool` | `''` | `1` para mostrar solo productos Prime. |
| `orderby` | `string` | `'date'` | Ordenar por: `date`, `price`, `rating`. |
| `order` | `string` | `'DESC'` | Direcci√≥n: `ASC` o `DESC`. |

## üé® Personalizaci√≥n de Dise√±o

Puedes ajustar la apariencia en **Productos Amazon > Settings > Design**.

- **Button Text**: Texto del bot√≥n de compra (ej: "Ver en Amazon").
- **Button Background**: Color de fondo del bot√≥n.
- **Button Text Color**: Color del texto del bot√≥n.
- **Price Color**: Color del precio del producto.

El plugin inyecta CSS din√°mico basado en estas configuraciones, por lo que no necesitas editar archivos CSS manualmente para cambios simples.

## üîß API Reference (PHP)

La clase `Glory\Plugins\AmazonProduct\Service\AmazonApiService` maneja todas las interacciones con la API de Amazon Data.

### `getDomain(string $region): string`
Retorna el dominio de Amazon correspondiente a un c√≥digo de regi√≥n.

**Par√°metros:**
- `$region` (string): C√≥digo de regi√≥n (ej: 'us', 'es', 'uk').

**Retorno:**
- (string): Dominio (ej: 'amazon.es'). Retorna 'amazon.com' por defecto.

```php
use Glory\Plugins\AmazonProduct\Service\AmazonApiService;
$domain = AmazonApiService::getDomain('es'); // 'amazon.es'
```

### `getProductByAsin(string $asin): array`
Obtiene los detalles de un producto por su ASIN. Utiliza cach√© (transient) de 1 d√≠a.

**Par√°metros:**
- `$asin` (string): El c√≥digo ASIN del producto.

**Retorno:**
- (array): Datos del producto o array vac√≠o si falla.

```php
$service = new AmazonApiService();
$product = $service->getProductByAsin('B08L5XHFWW');

if (!empty($product)) {
    echo $product['asin_name']; // T√≠tulo
    echo $product['asin_price']; // Precio
    echo $product['asin_images'][0]; // URL Imagen
}
```

### `searchProducts(string $keyword, int $page = 1): array`
Busca productos por palabra clave. Utiliza cach√© (transient) de 1 hora.

**Par√°metros:**
- `$keyword` (string): T√©rmino de b√∫squeda.
- `$page` (int): N√∫mero de p√°gina (default: 1).

**Retorno:**
- (array): Lista de productos encontrados.

```php
$results = $service->searchProducts('iphone 13', 1);
foreach ($results as $item) {
    echo $item['asin_name'];
}
```

### Metadatos del Post (`amazon_product`)
Adem√°s de la API, puedes acceder a los datos guardados en cada producto:

```php
$asin = get_post_meta($post_id, 'asin', true);
$price = get_post_meta($post_id, 'price', true);
$rating = get_post_meta($post_id, 'rating', true);
$reviews = get_post_meta($post_id, 'reviews', true);
$isPrime = get_post_meta($post_id, 'prime', true); // '1' o '0'
$url = get_post_meta($post_id, 'product_url', true);
```

## üì¶ Integraci√≥n con el Tema

El plugin est√° dise√±ado para ser agn√≥stico, pero se integra nativamente con Glory:

- **Assets**: Carga CSS/JS solo cuando se usa el shortcode o en p√°ginas relevantes.
- **AJAX**: Utiliza `gloryAjax` y respeta la navegaci√≥n del tema.
- **Dark Mode**: Soporta nativamente el modo oscuro del tema mediante variables CSS (`--amazon-bg`, `--amazon-text`, etc.).

### Estructura de Archivos
- `Glory/src/Plugins/AmazonProduct/`
  - `Controller/`: L√≥gica de admin y demo.
  - `Renderer/`: L√≥gica de renderizado frontend.
  - `Service/`: Comunicaci√≥n con API externa.
  - `assets/`: CSS y JS espec√≠ficos.

## ‚ö†Ô∏è Errores Frecuentes

- **Los productos no se importan**: Verifica que tu `RapidAPI Key` sea v√°lida y tengas cupo disponible. Revisa el log de errores de PHP.
- **Los enlaces no llevan a mi regi√≥n**: Aseg√∫rate de haber configurado la **Region** correcta en los ajustes.
- **El dise√±o se ve roto**: Verifica si alg√∫n plugin de cach√©/minificaci√≥n est√° interfiriendo con `amazon-product.css`.
- **No aparecen productos**: Aseg√∫rate de haber importado productos en la pesta√±a **Import Products**.

## üîÑ Modo Dev/Local

- **Sincronizaci√≥n**: En entorno local (`WP_ENVIRONMENT_TYPE='local'`), el Cron de actualizaciones puede no ejecutarse autom√°ticamente a menos que visites el sitio. Puedes forzar la sincronizaci√≥n manual desde la pesta√±a **Updates**.
- **API**: Las llamadas a la API son reales incluso en local. Usa la cach√© (transients) para evitar agotar tu cuota durante el desarrollo.
