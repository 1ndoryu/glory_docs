---
title: DefaultContentManager
description: "Define y sincroniza contenido por defecto para CPTs desde cdigo"
---

`DefaultContentManager` es una fachada agnstica que permite declarar contenido por defecto (posts/pginas) desde cdigo y sincronizarlo con la base de datos. La lgica reside en `DefaultContentRegistry` (almacenamiento en memoria) y `DefaultContentSynchronizer` (sincronizacin real).

## Resumen
- **Para qu sirve**: asegurar que cierto contenido exista y se mantenga segn definiciones versionadas.
- **Dnde va**: en el tema (`/App`), por ejemplo `App/Content/defaultContent.php`. Glory sigue siendo agnstico.

## Cundo usarlo
- Semillas de contenido inicial (home, polticas, landing demo).
- Contenido de sistema que no debe faltar.

## API bsica

```php
<?php
use Glory\Manager\DefaultContentManager;

/**
 * Define contenido por defecto para un tipo.
 * @param string $tipoPost  Slug del CPT (ej. 'page','libro').
 * @param array  $posts     Definiciones (ver estructura abajo).
 * @param string $modo      'none'|'force'|'smart' (def: 'smart').
 * @param bool   $eliminar  Eliminar posts obsoletos (def: false).
 */
DefaultContentManager::define(string $tipoPost, array $posts, string $modo = 'smart', bool $eliminar = false): void;

/** Registra hooks ('init' y deteccin de ediciones). */
DefaultContentManager::register(): void;
```

### Estructura de cada definicin (array $posts)
- **slugDefault**: string requerido y nico por CPT.
- **titulo**: ttulo del post.
- **contenido**: HTML seguro.
- **extracto**: string (opcional).
- **estado**: 'publish' (def), 'draft', etc.
- **metaEntrada**: array asociativo de metadatos. Si una clave coincide con una taxonoma del CPT, se asigna como trmino.
- **imagenDestacadaAsset**: referencia `alias::archivo.ext` o `random::alias`.
- **galeriaAssets**: array de referencias de assets (opcional).

## Ejemplo mnimo (tema)

```php
// App/Content/defaultContent.php
use Glory\Manager\DefaultContentManager;

DefaultContentManager::define('libro', [
    [
        'slugDefault' => 'el-principito',
        'titulo'      => 'El Principito',
        'contenido'   => 'Una novela potica...',
        'imagenDestacadaAsset' => 'elements::libros/principito.jpeg',
    ],
]);
```

## Parmetros y modos
- **modo**: 'none' (no actualiza), 'force' (sobrescribe siempre), 'smart' (actualiza solo si no fue editado manualmente y hay cambios).
- **eliminar**: si `true`, borra entradas gestionadas cuyo `slugDefault` ya no est en cdigo.

## API avanzada

```php
/** Genera posts de ejemplo con slugs y contenido deterministas. */
DefaultContentManager::buildSamplePosts(array $titles, array $paragraphs, array $options = []): array;
```

### Options de buildSamplePosts
- **aliasImagenes**: alias de AssetsUtility (def: 'colors').
- **minBytes**: filtro de tamao mnimo (bytes).

## Modo Dev/Local vs Produccin
- La sincronizacin no corre automticamente en front. Se ejecuta desde el panel (SyncManager) o CLI.
- Activa `defaultContentManager` y `syncManager` en `App/Config/control.php`.
- Recomendacin: usar `smart` en prod; `force` solo en despliegues controlados. Evitar `eliminar` en prod salvo certeza.

## Errores frecuentes
- Falta `slugDefault` o CPT no existe al sincronizar.
- Assets inexistentes en `imagenDestacadaAsset`/`galeriaAssets`.
- Taxonomas declaradas en `metaEntrada` que no existen para el CPT.

## Integracin con el tema
- Define el contenido en `App/Content/defaultContent.php` (tema).
- La registracin de hooks la realiza el core si la feature `defaultContentManager` est activa.
