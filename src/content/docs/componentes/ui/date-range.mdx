---
title: Selector de Rangos de Fecha
description: Componente para selecci√≥n de rangos de fechas con interfaz intuitiva y validaci√≥n autom√°tica
---

import { Card, CardGrid } from '@astrojs/starlight/components';

# Selector de Rangos de Fecha (`gloryDateRange.js`)

El selector de rangos de fecha proporciona una interfaz intuitiva para seleccionar periodos de tiempo, reemplazando campos de fecha tradicionales con un popover elegante que incluye validaci√≥n autom√°tica y integraci√≥n con formularios AJAX.

## üöÄ Inicio R√°pido

```html
<!-- Campo b√°sico de rango de fechas -->
<input type="text" class="gloryDateRangeInput"
       data-from-name="fecha_desde"
       data-to-name="fecha_hasta"
       placeholder="Seleccionar rango de fechas">

<!-- Campos ocultos para almacenar valores -->
<input type="hidden" name="fecha_desde" value="">
<input type="hidden" name="fecha_hasta" value="">
```

```javascript
// El sistema se inicializa autom√°ticamente
// No requiere configuraci√≥n adicional
```

## üìã Funcionalidades

### Selecci√≥n Interactiva
Popover que aparece al hacer clic o foco en el campo de entrada, mostrando dos selectores de fecha (desde/hasta).

```html
<!-- Ejemplo completo con pre-selecci√≥n -->
<input type="text" class="gloryDateRangeInput"
       data-from-name="fecha_inicio"
       data-to-name="fecha_fin"
       placeholder="Seleccione el per√≠odo">

<input type="hidden" name="fecha_inicio" value="2024-01-01">
<input type="hidden" name="fecha_fin" value="2024-12-31">
```

### Modos de Operaci√≥n

#### Modo Frontend
- Aplicaci√≥n autom√°tica al cambiar fechas
- Cierre autom√°tico cuando ambas fechas est√°n seleccionadas
- Env√≠o autom√°tico del formulario padre

#### Modo Admin (wp-admin)
- Botones "Aplicar" y "Limpiar" para control manual
- No env√≠o autom√°tico del formulario

## üé® Caracter√≠sticas Visuales

### Interfaz del Popover
- **Header**: "Rango de fechas" con iconograf√≠a clara
- **Body**: Dos campos de fecha etiquetados ("Desde" y "Hasta")
- **Actions**: Botones contextuales seg√∫n el entorno

### Estilos y Animaciones
- Popover posicionado din√°micamente debajo del campo
- Cierre autom√°tico al hacer clic fuera
- Adaptable a scroll y resize de ventana
- Un solo popover activo a la vez

### Estructura HTML Generada

```html
<!-- Popover generado din√°micamente -->
<div class="gloryDateRangePopover">
    <div class="gdr-head">Rango de fechas</div>
    <div class="gdr-body">
        <label>Desde</label>
        <input type="date" class="gdr-from">
        <label>Hasta</label>
        <input type="date" class="gdr-to">
    </div>
    <div class="gdr-actions">
        <!-- Botones seg√∫n contexto -->
        <button class="button gdr-apply">Aplicar</button>
        <button class="button gdr-clear">Limpiar</button>
    </div>
</div>
```

## üîß Configuraci√≥n Avanzada

### Atributos de Datos

#### `data-from-name`
Nombre del campo oculto para la fecha de inicio.
```html
<input class="gloryDateRangeInput" data-from-name="fecha_desde">
```

#### `data-to-name`
Nombre del campo oculto para la fecha de fin.
```html
<input class="gloryDateRangeInput" data-to-name="fecha_hasta">
```

### Variables Globales de Control

```javascript
// Control de inicializaci√≥n
window.__gloryDateRangeInitialized__ = false; // Flag de inicializaci√≥n
window.__gloryDateRangeClose__ = null; // Funci√≥n de cierre actual
```

## üìù API T√©cnica

### Funciones Principales

#### `gloryDateRangeInit()`
Inicializa el sistema de rangos de fecha y configura los event listeners.

```javascript
// Inicializaci√≥n manual (generalmente autom√°tica)
window.gloryDateRangeInit();

// Se ejecuta autom√°ticamente en:
// - DOMContentLoaded
// - Evento 'gloryRecarga'
```

#### `openPopover(input)`
Abre el popover para un campo espec√≠fico.

#### `closeAnyPopover()`
Cierra cualquier popover abierto actualmente.

### Eventos

#### `gloryRecarga`
Reinicializa el sistema completo.

```javascript
document.addEventListener('gloryRecarga', function(){
    window.__gloryDateRangeInitialized__ = false;
    window.gloryDateRangeInit();
});
```

#### Eventos de Formulario
- **Frontend**: `submit` autom√°tico en el formulario padre
- **Admin**: Sin env√≠o autom√°tico (control manual)

## üéØ Casos de Uso

### Filtros de Contenido
```html
<!-- Filtro de posts por fecha -->
<div class="filtros-contenido">
    <input type="text" class="gloryDateRangeInput"
           data-from-name="fecha_desde"
           data-to-name="fecha_hasta"
           placeholder="Filtrar por fecha de publicaci√≥n">

    <input type="hidden" name="fecha_desde">
    <input type="hidden" name="fecha_hasta">
</div>
```

### Reportes y Analytics
```html
<!-- Selector de per√≠odo para reportes -->
<div class="selector-periodo">
    <label>Per√≠odo del reporte:</label>
    <input type="text" class="gloryDateRangeInput"
           data-from-name="reporte_desde"
           data-to-name="reporte_hasta">
</div>
```

### Reservas y Calendarios
```html
<!-- Sistema de reservas -->
<div class="reserva-fechas">
    <input type="text" class="gloryDateRangeInput"
           data-from-name="checkin"
           data-to-name="checkout"
           placeholder="Seleccionar fechas de estad√≠a">
</div>
```

## üîÑ Compatibilidad

- ‚úÖ **Auto-inicializaci√≥n**: Funciona sin configuraci√≥n manual
- ‚úÖ **Responsive**: Se adapta a diferentes dispositivos
- ‚úÖ **Accesibilidad**: Soporte b√°sico para navegaci√≥n por teclado
- ‚úÖ **Integraci√≥n AJAX**: Compatible con `gloryAjax` para env√≠os autom√°ticos
- ‚úÖ **Validaci√≥n**: Campos de fecha nativos del navegador
- ‚úÖ **Cross-browser**: Compatible con navegadores modernos

## üêõ Soluci√≥n de Problemas

### Problemas Comunes

1. **Popover no aparece**: Verificar clase `gloryDateRangeInput` en el campo
2. **Campos ocultos no se actualizan**: Revisar atributos `data-from-name` y `data-to-name`
3. **Posicionamiento incorrecto**: Verificar que no haya CSS que interfiera con `position: absolute`

### Debug
```javascript
// Verificar inicializaci√≥n
console.log('DateRange inicializado:', window.__gloryDateRangeInitialized__);

// Forzar reinicializaci√≥n
window.__gloryDateRangeInitialized__ = false;
window.gloryDateRangeInit();

// Verificar elementos
const inputs = document.querySelectorAll('.gloryDateRangeInput');
console.log('Campos encontrados:', inputs.length);
```

### Verificaci√≥n de Funcionalidad
```javascript
// Test b√°sico
const testInput = document.querySelector('.gloryDateRangeInput');
if (testInput) {
    testInput.focus(); // Deber√≠a abrir el popover
    console.log('Popover deber√≠a estar visible');
}
```
















