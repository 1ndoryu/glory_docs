---
title: AssetManager
description: Registro y gestión de scripts y estilos en Glory
---

## Resumen

Gestiona el registro y encolado de scripts y estilos del tema. Permite definir assets puntuales o auto‑descubrir una carpeta completa con un solo llamado.

## Cuándo usarlo
- Cuando el tema necesite registrar CSS/JS propios.
- Cuando quieras auto‑descubrir y versionar archivos por carpeta con un prefijo uniforme.
- No lo uses para lógica del core: el núcleo de Glory debe permanecer agnóstico del tema.

## API

```php
// define(type, handle, ruta, config)
AssetManager::define(
    'script',                 // type: 'script' | 'style'
    'miHandle',               // handle: identificador único sin espacios
    'App/Assets/js/app.js',   // ruta: relativa al tema; detecta .min.* si existe
    [
        'deps'      => ['jquery'],                 // dependencias WP
        'in_footer' => true,                       // solo scripts
        'media'     => 'all',                      // solo estilos
        'area'      => 'frontend',                 // 'frontend'|'admin'|'both'
        'feature'   => 'miFeature',                // requiere feature activa
        'localize'  => [                           // objeto JS inyectado
            'nombreObjeto' => 'misDatos',
            'datos'        => ['ajaxUrl' => admin_url('admin-ajax.php')],
        ],
        'defer'     => true,                       // por defecto true en scripts
        'ver'       => '0.1.1',                    // override de versión del tema
    ]
);

// defineFolder(type, carpeta, config = [], prefijo = '', excluir = [])
AssetManager::defineFolder(
    'style',                   // type
    'App/Assets/css/',         // carpeta relativa al tema
    ['media' => 'all'],        // config aplicada a todos los archivos
    'tema-',                   // prefijo del handle
    ['task.css']               // excluir archivos concretos
);
```

Métodos auxiliares: `AssetManager::setThemeVersion(version)` (cache busting) y `AssetManager::setGlobalDevMode(bool)` (desactiva la caché del auto‑descubrimiento en desarrollo).

Parámetros complejos:
- **localize**: genera una variable global JS con `nombreObjeto` que contiene `datos`. Útil para pasar `ajaxUrl`, nonces u opciones del tema sin escribir inline scripts manuales.

Nota: El registro/encolado se engancha automáticamente a los hooks de WP (no necesitas llamar a `register()` explícitamente).

## Ejemplo mínimo

```php
use Glory\Manager\AssetManager;

AssetManager::defineFolder(
    'script',
    'App/Assets/js/',
    ['deps' => ['jquery'], 'in_footer' => true],
    'tema-'
);
```

## Notas y límites
- Requiere tener activa la feature `assetManager` en `App/Config/control.php`.
- Fuera de modo desarrollo, el auto‑descubrimiento se cachea y prioriza archivos `.min.*` si existen.
- Para datos dinámicos en JS, usa `localize` con `nombreObjeto` y `datos` (se emite vía `wp_localize_script`).

## Integración con el tema
- Define tus assets del tema en `App/Config/assets.php` agrupando por carpeta cuando sea posible.
- Usa `AssetManager::setThemeVersion('0.1.1')` en `App/Config/config.php` para controlar el cache busting del tema.
