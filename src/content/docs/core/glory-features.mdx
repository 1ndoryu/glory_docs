---
title: GloryFeatures
description: Control de features y overrides en Glory
---

`GloryFeatures` centraliza el control de funcionalidades (features) que pueden activarse/desactivarse
mediante código o mediante opciones en el panel. Esta página documenta la API pública, la precedencia
entre overrides por código y opciones de la base de datos, y patrones de uso recomendados.

## Concepto

- Una *feature* es una funcionalidad opcional del framework (p. ej. `gloryRealtime`, `cssCritico`).
- Glory permite controlar el estado de una feature desde dos fuentes principales:
  1. **Override por código**: el desarrollador puede forzar la activación/desactivación en tiempo de ejecución.
  2. **Opción en la base de datos**: una opción gestionada por `OpcionManager` que el administrador puede cambiar desde el panel.

## API principal

- `GloryFeatures::enable(string $feature): void` — Activa permanentemente la feature en el runtime.
- `GloryFeatures::disable(string $feature): void` — Desactiva permanentemente la feature en el runtime.
- `GloryFeatures::isEnabled(string $feature): ?bool` — Devuelve el override por código: `true`, `false` o `null` si no hay override.
- `GloryFeatures::isActive(string $feature, ?string $optionKey = null, bool $default = true): bool` — Decide si la feature está activa combinando override y opción en BD.

> Nota: `isActive` es la llamada que normalmente debes usar cuando registras assets, hooks o funcionalidades dependientes de la configuración.

## Precedencia y comportamiento (explicación muy sencilla)

- `isEnabled('feature')` — pregunta si el desarrollador **forzó** la feature en el código.
  - Devuelve `true` = forzó activarla.
  - Devuelve `false` = forzó desactivarla.
  - Devuelve `null` = no hay override por código.

- `isActive('feature', $optionKey, $default)` — devuelve si la feature está realmente activa en el sitio. Reglas simples:
  1. Si `isEnabled` devuelve `true` o `false`, `isActive` devuelve ese valor (el override por código manda).
  2. Si `isEnabled` devuelve `null`, `isActive` mira la opción en la base de datos (`optionKey`):
     - Si la opción existe en BD, devuelve ese valor (lo que configuró el cliente final / administrador del sitio desde el panel).
     - Si la opción no existe, devuelve `default` (valor por defecto que tú pases).

Ejemplos rápidos:

- Caso 1: el dev hizo `isEnabled('X') === true` → `isActive('X')` devuelve `true`.
- Caso 2: `isEnabled('X') === null`, en BD `optionKey` = `false` → `isActive` devuelve `false`.
- Caso 3: `isEnabled('X') === null`, en BD no existe la opción → `isActive` devuelve `default`.

Pseudocódigo sencillo:

```php
$override = GloryFeatures::isEnabled('X'); // true | false | null
if ($override !== null) return $override;
if (option_exists('optionKey')) return get_option('optionKey');
return $default;
```

## Ejemplos de uso

**Uso mínimo** - Activar/desactivar feature:
```php
use Glory\Core\GloryFeatures;

// Activar feature
GloryFeatures::enable('miFeature');

// Verificar si está activa
if (GloryFeatures::isActive('miFeature')) {
    // Código aquí
}
```

**Uso avanzado** - Con opción de BD:
```php
// Verificar con opción personalizada y valor por defecto
if (GloryFeatures::isActive('miFeature', 'mi_opcion_personalizada', false)) {
    AssetManager::define('script', 'mi-script', '/assets/js/script.js');
}
```

## Integración con AssetManager

AssetManager soporta `'feature'` para cargar assets condicionalmente:

```php
AssetManager::define('script', 'mi-script', '/assets/js/script.js', [
    'feature' => 'miFeature' // Solo carga si la feature está activa
]);
```

¡Usa GloryFeatures para controlar funcionalidades dinámicamente!



