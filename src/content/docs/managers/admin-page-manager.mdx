---
title: AdminPageManager
description: Gestión de páginas de administración en WordPress
---

## Resumen

Gestiona la creación de páginas de administración en WordPress de forma programática. Permite definir páginas de nivel superior y submenús que se registran automáticamente con el hook `admin_menu` de WordPress.

## Cuándo usarlo

- Cuando necesites crear páginas personalizadas en el área de administración de WordPress.
- Cuando quieras centralizar la definición de menús de administración desde código.
- Cuando requieras páginas de configuración para opciones del tema o funcionalidades personalizadas.
- No lo uses para páginas de opciones simples: usa `add_options_page()` directamente si solo necesitas una página de configuración básica.

## API básica

```php
// defineTopLevel(page_title, menu_title, capability, menu_slug, function, icon_url, position)
AdminPageManager::defineTopLevel(
    'Título de la Página',        // page_title: título en la etiqueta <title>
    'Texto del Menú',             // menu_title: texto visible en el menú
    'manage_options',             // capability: capacidad WP requerida (ej: 'manage_options', 'edit_posts')
    'mi-menu-slug',               // menu_slug: identificador único (sin espacios, usar guiones)
    null,                         // function: callback que renderiza la página (string|callable|null)
    'dashicons-admin-generic',    // icon_url: URL del icono o clase Dashicon (string, opcional)
    null                          // position: posición numérica en el menú (int|null, opcional)
);

// defineSubmenu(parent_slug, page_title, menu_title, capability, menu_slug, function, position)
AdminPageManager::defineSubmenu(
    'mi-menu-slug',               // parent_slug: slug del menú padre (debe existir)
    'Título de la Subpágina',     // page_title: título en la etiqueta <title>
    'Texto del Submenú',          // menu_title: texto visible en el submenú
    'manage_options',             // capability: capacidad WP requerida
    'mi-submenu-slug',            // menu_slug: identificador único del submenú
    null,                         // function: callback que renderiza la página (string|callable|null)
    null                          // position: posición numérica en el submenú (int|null, opcional)
);

// register()
AdminPageManager::register();     // Engancha 'admin_menu' y crea todas las páginas definidas
```

Parámetros complejos:

- **function**: puede ser `null` (página vacía), un `string` con el nombre de la función callback, o un `callable`. La función debe estar definida antes de llamar a `register()` y debe aceptar cero parámetros. Si es `null`, WordPress mostrará una página vacía.
- **icon_url**: puede ser una clase Dashicon (ej: `'dashicons-admin-generic'`), una URL absoluta a una imagen, o cadena vacía `''` para usar el icono por defecto. Ver [Dashicons](https://developer.wordpress.org/resource/dashicons/) para opciones disponibles.
- **position**: controla el orden en el menú. Valores comunes: `2` (Dashboard), `4` (Separador), `59` (Separador antes de Apariencia), `60` (Apariencia), `65` (Plugins), `80` (Herramientas), `100` (Ajustes). Si es `null`, WordPress asigna automáticamente.

## Ejemplo mínimo

```php
use Glory\Manager\AdminPageManager;

// Definir página principal
AdminPageManager::defineTopLevel(
    'Configuración del Tema',
    'Mi Tema',
    'manage_options',
    'mi-tema-config',
    'render_config_tema',
    'dashicons-admin-settings'
);

// Registrar (debe llamarse después de definir todas las páginas)
AdminPageManager::register();

// Función callback
function render_config_tema() {
    echo '<div class="wrap">';
    echo '<h1>Configuración del Tema</h1>';
    echo '<p>Contenido de la página...</p>';
    echo '</div>';
}
```

## Ejemplo avanzado

```php
use Glory\Manager\AdminPageManager;

// Página principal con submenús
AdminPageManager::defineTopLevel(
    'Panel de Control',
    'Mi Panel',
    'manage_options',
    'mi-panel',
    'render_panel_principal',
    'dashicons-dashboard',
    25  // Posición específica en el menú
);

// Submenús
AdminPageManager::defineSubmenu(
    'mi-panel',
    'Configuración General',
    'General',
    'manage_options',
    'mi-panel-general',
    'render_config_general',
    1  // Primera posición en el submenú
);

AdminPageManager::defineSubmenu(
    'mi-panel',
    'Configuración Avanzada',
    'Avanzado',
    'manage_options',
    'mi-panel-avanzado',
    'render_config_avanzada',
    2  // Segunda posición
);

// Registrar todo
AdminPageManager::register();

// Funciones callback
function render_panel_principal() {
    echo '<div class="wrap">';
    echo '<h1>Panel de Control</h1>';
    echo '<p>Bienvenido al panel principal.</p>';
    echo '</div>';
}

function render_config_general() {
    echo '<div class="wrap">';
    echo '<h1>Configuración General</h1>';
    // Formulario de opciones...
    echo '</div>';
}

function render_config_avanzada() {
    echo '<div class="wrap">';
    echo '<h1>Configuración Avanzada</h1>';
    // Opciones avanzadas...
    echo '</div>';
}
```

Notas del ejemplo:
- Las páginas se definen antes de llamar a `register()`.
- Los callbacks deben estar definidos antes de `register()`.
- `position` controla el orden: valores menores aparecen primero.
- Los submenús se agrupan bajo el `parent_slug` especificado.

## Recomendaciones de uso

- Define todas las páginas en `App/Config/admin-pages.php` o similar, agrupadas por funcionalidad.
- Usa slugs descriptivos y consistentes (preferencia: `kebab-case`).
- Usa capacidades estándar de WordPress (`manage_options`, `edit_posts`, etc.) o capacidades personalizadas definidas por plugins de roles.
- Prefiere clases Dashicons para iconos (más rápido y consistente con WordPress).
- Llama a `register()` una sola vez después de definir todas las páginas (normalmente en `App/Config/control.php` o durante la inicialización del tema).
- Si necesitas pasar datos al callback, usa variables globales o closures (WordPress no permite parámetros adicionales en callbacks de páginas admin).

## Notas y límites

- Si intentas definir una página de nivel superior con un `menu_slug` duplicado, se registra un warning en el log y se omite la redefinición.
- Los submenús pueden tener `menu_slug` duplicados (se añaden todos), pero es recomendable usar slugs únicos.
- El registro se engancha automáticamente al hook `admin_menu` de WordPress cuando llamas a `register()`.
- Las funciones callback deben estar disponibles cuando WordPress ejecuta `admin_menu` (definirlas antes de `register()` o en el mismo archivo).
- Si `function` es `null`, WordPress mostrará una página vacía (útil para páginas que solo contienen submenús).

## Modo Dev/Local

- No hay diferencias de comportamiento entre modo dev y producción.
- El registro de páginas ocurre siempre que se llame a `register()`, independientemente del modo.
- Las páginas se crean en cada carga del área de administración.

## Integración con el tema

- Define las páginas de administración del tema en `App/Config/admin-pages.php`.
- Llama a `AdminPageManager::register()` en `App/Config/control.php` o durante la inicialización del tema.
- Las funciones callback pueden vivir en `App/Functions/` o en el mismo archivo de configuración.
- Para páginas que usan `OpcionManager`, combina ambos managers: define las opciones con `OpcionManager::register()` y crea la página de administración con `AdminPageManager::defineTopLevel()`.

## Diferencias: páginas del tema vs páginas de Glory

- Tema (`/App`):
  - Se definen en `App/Config/admin-pages.php` con `AdminPageManager`.
  - Son específicas del proyecto/tema.
  - Se usan para configuraciones y opciones del tema.
- Glory (`/Glory`):
  - Las páginas del núcleo de Glory son agnósticas y se definen internamente si es necesario.
  - No deben definirse desde el tema; si necesitas páginas del core, consulta la documentación específica.

## Errores frecuentes (rápido)

- Definir páginas después de llamar a `register()` (no se registrarán).
- Usar callbacks no definidos (error fatal).
- Duplicar `menu_slug` en páginas de nivel superior (se omite la segunda definición).
- Olvidar llamar a `register()` (las páginas no aparecen en el admin).
- Usar `parent_slug` inexistente en submenús (el submenú no aparece).
- Pasar parámetros adicionales a callbacks (WordPress no los soporta; usar variables globales o closures).
